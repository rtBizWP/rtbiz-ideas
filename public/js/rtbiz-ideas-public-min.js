/*! 
 * rtBiz Helpdesk JavaScript Library 
 * @package rtBiz Helpdesk 
 */!function(a){"use strict";a(document).ready(function(){jQuery.fn.highlight=function(a){function b(a,c){var d=0;if(3==a.nodeType){var e=a.data.toUpperCase().indexOf(c);if(e>=0){var f=document.createElement("span");f.className="highlight";var g=a.splitText(e),h=(g.splitText(c.length),g.cloneNode(!0));f.appendChild(h),g.parentNode.replaceChild(f,g),d=1}}else if(1==a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(var i=0;i<a.childNodes.length;++i)i+=b(a.childNodes[i],c);return d}return this.each(function(){b(this,a.toUpperCase())})};var b={init:function(){b.toggleIdeasForm(),b.voteIdeas(),b.searchIdeas(),b.loadMoreIdeas(),b.subscribeIdeas(),b.saveIdeasEmailNotification()},toggleIdeasForm:function(){a('a[href="#Idea-new"]').click(function(){jQuery("#wpideas-insert-idea").slideToggle("slow")})},voteIdeas:function(){a(".btnVote").on("click",function(){a(this).attr("disabled","disabled");var b={};b.action="rtbiz_ideas_vote",b.postid=a(this).data("id"),a.ajax({url:ajaxurl,type:"POST",dataType:"json",data:b,success:function(c){c.vote?(a("#rtwpIdeaVoteCount-"+b.postid).html(c.vote),a("#btnVote-"+b.postid).removeAttr("disabled"),a("#btnVote-"+b.postid).attr("value",c.btnLabel)):(alert(c.err),a("#btnVote-"+b.postid).removeAttr("disabled"))},error:function(c,d,e){a("#btnVote-"+b.postid).removeAttr("disabled")}})})},searchIdeas:function(){a("#txtSearchIdea").keyup(function(){var b={};b.action="rtbiz_ideas_search",b.searchtext=a(this).val(),a.ajax({url:ajaxurl,type:"POST",dataType:"text",data:b,success:function(c){a("#loop-common").html(c),b.searchtext&&(a(".rtwpIdeaTitle").highlight(b.searchtext),a(".rtwpIdeaDescription").highlight(b.searchtext))},error:function(a,b,c){}})})},loadMoreIdeas:function(){a("#ideaLoadMore").on("click",function(b){jQuery("#ideaLoadMore").hide(),jQuery("#ideaLoading").show();var c={};c.action="rtbiz_ideas_load_more",c.offset=a("#wpidea-content article").length,c.nonce=jQuery("#ideaLoadMore").attr("data-nonce"),c.post_type=rtbiz_ideas_posttype,c.product_id=a("#idea_product_id").val(),c.postparpage=jQuery("#idea_post_per_page").val(),c.idea_order=jQuery("#idea_order").val(),c.idea_orderby=jQuery("#idea_order_by").val(),c.processData=!1,c.contentType=!1,a.ajax({url:ajaxurl,type:"POST",dataType:"json",data:c,success:function(b){if(b.have_posts){var c=a(b.html.replace(/(\r\n|\n|\r)/gm,""));a("#wpidea-content").append(c),jQuery("#ideaLoadMore").show()}else a("#ideaLoadMore").hide();jQuery("#ideaLoading").hide()},error:function(a,b,c){}})})},subscribeIdeas:function(){a(".subscribe_email_notification_button").on("click",function(b){var c=jQuery(this).attr("id"),d={};d.action="rtbiz_ideas_subscribe_button",d.post_id=a(this).data("id"),a.ajax({url:ajaxurl,type:"POST",dataType:"json",data:d,success:function(a){a.status&&(jQuery("a[id="+c+"]").length?jQuery("#"+c).text(a.btntxt):jQuery("input[id= "+c+"]").length&&(jQuery("#"+c).attr("value",a.btntxt),jQuery("#"+c).toggleClass("button-unsubscribe button-subscribe")))},error:function(a,b,c){}})})},saveIdeasEmailNotification:function(){var b=jQuery("#status_change_notification").is(":checked"),c=jQuery("#comment_notification").is(":checked");jQuery("#user_notification_save").click(function(){var d={},e=jQuery("#status_change_notification").is(":checked"),f=jQuery("#comment_notification").is(":checked");d.action="rtbiz_ideas_subscribe_notification_setting",e!=b&&(d.status_change_notification=e?"YES":"NO"),f!=c&&(d.comment_notification=f?"YES":"NO"),(e!=b||f!=c)&&a.ajax({url:ajaxurl,type:"POST",dataType:"json",data:d,success:function(a){a.status&&a.status&&jQuery("#Notificationstatus").show()},error:function(a,b,c){}})})}};b.init()})}(jQuery);